Doubt when res -> last == intervals -> first